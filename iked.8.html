<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<title>
IKED(8)</title>
    <script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-35930566-1']);
	_gaq.push(['_trackPageview']);
	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
    </script>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
IKED(8)</td>
<td class="head-vol">
System Manager's Manual</td>
<td class="head-rtitle">
IKED(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">iked</b> &#8212; <span class="desc">Internet Key Exchange version 2 (IKEv2) daemon</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 4.00ex;"/>
<col/>
<tbody>
<tr>
<td>
iked</td>
<td>
[<span class="opt"><b class="flag">-6dnSTtv</b></span>] [<span class="opt"><b class="flag">-D</b> <i class="arg">macro</i>=<i class="arg">value</i></span>] [<span class="opt"><b class="flag">-f</b> <i class="arg">file</i></span>]</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">iked</b> is an Internet Key Exchange (IKEv2) daemon which performs mutual authentication and which establishes and maintains IPsec flows and security associations (SAs) between the two peers.<div class="spacer">
</div>
The IKEv2 protocol is defined in RFC 5996, which combines and updates the previous standards: ISAKMP/Oakley (RFC 2408), IKE (RFC 2409), and the Internet DOI (RFC 2407). <b class="name">iked</b> only supports the IKEv2 protocol; support for ISAKMP/Oakley and IKEv1 is provided by <a class="link-man">isakmpd(8)</a>.<div class="spacer">
</div>
<b class="name">iked</b> supports mutual authentication using RSA public keys and X.509 certificates. See the <i class="link-sec"><a class="link-sec" href="#x5055424c4943204b45592041555448454e5449434154494f4e">PUBLIC KEY AUTHENTICATION</a></i> section below and PKI AND CERTIFICATE AUTHORITY COMMANDS in <a class="link-man">ikectl(8)</a> for more information about creating and maintaining the public key infrastructure.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-6</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Disable automatic blocking of IPv6 traffic. By default, <b class="name">iked</b> blocks any IPv6 traffic unless a flow for this address family has been negotiated. This option is used to prevent VPN traffic leakages on dual stack hosts.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-D</b> <i class="arg">macro</i>=<i class="arg">value</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Define <i class="arg">macro</i> to be set to <i class="arg">value</i> on the command line. Overrides the definition of <i class="arg">macro</i> in the configuration file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-d</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Do not daemonize and log to <span class="emph">stderr</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-f</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use <i class="arg">file</i> as the configuration file, instead of the default <i class="file">/etc/iked.conf</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-n</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Configtest mode. Only check the configuration file for validity.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-S</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Start <b class="name">iked</b> in passive mode. See the <b class="cmd">set passive</b> option in <a class="link-man">iked.conf(5)</a> for more information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-T</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Disable NAT-Traversal and do not propose NAT-Traversal support to the peers.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-t</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enforce NAT-Traversal and only listen to NAT-Traversal messages. This option is only recommended for testing; the default is to negotiate NAT-Traversal with the peers.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-v</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Produce more verbose output.</dd>
</dl>
</div>
<div class="section">
<h1 id="x5055424c4943204b45592041555448454e5449434154494f4e">PUBLIC KEY AUTHENTICATION</h1> It is possible to store trusted public keys to make them directly usable by <b class="name">iked</b>, bypassing the need to use certificates. The keys should be saved in PEM format (see <a class="link-man">openssl(1)</a>) and named and stored as follows:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
For IPv4 identities:</dt>
<dd class="list-tag" style="margin-left: 22.00ex;">
/etc/iked/pubkeys/ipv4/A.B.C.D</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
For IPv6 identities:</dt>
<dd class="list-tag" style="margin-left: 22.00ex;">
/etc/iked/pubkeys/ipv6/abcd:abcd::ab:bc</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
For FQDN identities:</dt>
<dd class="list-tag" style="margin-left: 22.00ex;">
/etc/iked/pubkeys/fqdn/foo.bar.org</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
For UFQDN identities:</dt>
<dd class="list-tag" style="margin-left: 22.00ex;">
/etc/iked/pubkeys/ufqdn/user@foo.bar.org</dd>
</dl>
<div class="spacer">
</div>
Depending on the <b class="cmd">srcid</b> and <b class="cmd">dstid</b> specifications in <a class="link-man">iked.conf(5)</a>, keys may be named after their IPv4 address, IPv6 address, fully qualified domain name (FQDN) or user fully qualified domain name (UFQDN).<div class="spacer">
</div>
For example, <b class="name">iked</b> can authenticate using the pre-generated keys if the local public key, by default <i class="file">/etc/iked/local.pub</i>, is copied to the remote gateway as <i class="file">/etc/iked/pubkeys/ipv4/local.gateway.ip.address</i> and the remote gateway's public key is copied to the local gateway as <i class="file">/etc/iked/pubkeys/ipv4/remote.gateway.ip.address</i>. Of course, new keys may also be generated (the user is not required to use the pre-generated keys). In this example, <b class="cmd">srcid</b> and <b class="cmd">dstid</b> would also have to be set to the specified addresses in <a class="link-man">iked.conf(5)</a>.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/iked.conf</i></dt>
<dd class="list-tag" style="margin-left: 21.00ex;">
The default <b class="name">iked</b> configuration file.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/iked/ca/</i></dt>
<dd class="list-tag" style="margin-left: 21.00ex;">
The directory where CA certificates are kept.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/iked/certs/</i></dt>
<dd class="list-tag" style="margin-left: 21.00ex;">
The directory where IKE certificates are kept, both the local certificate(s) and those of the peers, if a choice to have them kept permanently has been made.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/iked/crls/</i></dt>
<dd class="list-tag" style="margin-left: 21.00ex;">
The directory where CRLs are kept.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/iked/private/</i></dt>
<dd class="list-tag" style="margin-left: 21.00ex;">
The directory where local private keys used for public key authentication are kept. The file <i class="file">local.key</i> is used to store the local private key.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/iked/pubkeys/</i></dt>
<dd class="list-tag" style="margin-left: 21.00ex;">
The directory in which trusted public keys are kept. The keys must be named in the fashion described above.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/run/iked.sock</i></dt>
<dd class="list-tag" style="margin-left: 21.00ex;">
The default <b class="name">iked</b> control socket.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man">iked.conf(5)</a>, <a class="link-man">ikectl(8)</a>, <a class="link-man">isakmpd(8)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> <span class="ref"><span class="ref-auth">C. Kaufman</span>, <span class="ref-auth">P. Hoffman</span>, <span class="ref-auth">Y. Nir</span>, and <span class="ref-auth">P. Eronen</span>, <span class="ref-title">Internet Key Exchange Protocol Version 2 (IKEv2)</span>, <span class="ref-rep">RFC 5996</span>, <span class="ref-date">September 2010</span>.</span></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">iked</b> program first appeared in <span class="unix">OpenBSD&#160;4.8</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The <b class="name">iked</b> program was written by <span class="author">Reyk Floeter</span> &lt;<a class="link-mail" href="mailto:reyk@openbsd.org">reyk@openbsd.org</a>&gt;.</div>
<table class="foot">
<tbody>
<tr>
<td class="foot-date">
November 10, 2014</td>
<td class="foot-os">
OpenBSD 5.8</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

